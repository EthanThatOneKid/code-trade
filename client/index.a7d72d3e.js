import{w as e,S as a,i as t,s as r,a as s,e as n,t as o,q as d,d as i,c,b as u,f as l,g as p,h as f,j as h,k as T,l as g,r as m,m as b,p as C,n as v,o as P,u as E}from"./client.9036fb66.js";const y=e({tradePartnerFriendCode:null,isTrading:!1}),F=()=>{const e=window.location.host||"localhost:3000",a=new WebSocket(`wss://${e}`);console.log({socket:a}),a.addEventListener("open",e=>{console.log("SOCKET CONNECTED")}),a.addEventListener("message",({data:e})=>{const{type:a,details:{tradePartnerFriendCode:t}}=JSON.parse(e);switch(a){case"trade_partner_found":y.set({tradePartnerFriendCode:`Trade partner found!\r\n${t}`,isTrading:!1});break;default:console.log(`No message type ${a} accounted for.`)}});return{subscribe:y.subscribe,requestTradePartner:e=>{if(a.readyState<=1){const t=JSON.stringify({type:"request_trade_partner",details:{clientFriendCode:e}});y.set({tradePartnerFriendCode:"Waiting for trade partner...",isTrading:!0}),a.send(t)}}}};function N(e){let a,t,r,E,y,F,N,w,S,O,k,q;return{c(){a=s(),t=n("h1"),r=o("Code Trade"),E=s(),y=n("p"),F=o(e[1]),N=s(),w=n("form"),S=n("input"),O=s(),k=n("input"),this.h()},l(s){d('[data-svelte="svelte-ccncm0"]',document.head).forEach(i),a=c(s),t=u(s,"H1",{});var n=l(t);r=p(n,"Code Trade"),n.forEach(i),E=c(s),y=u(s,"P",{});var o=l(y);F=p(o,e[1]),o.forEach(i),N=c(s),w=u(s,"FORM",{});var f=l(w);S=u(f,"INPUT",{}),O=c(f),k=u(f,"INPUT",{type:!0,value:!0}),f.forEach(i),this.h()},h(){document.title="Code Trade",f(k,"type","submit"),k.value="Trade!"},m(s,n,o){h(s,a,n),h(s,t,n),T(t,r),h(s,E,n),h(s,y,n),T(y,F),h(s,N,n),h(s,w,n),T(w,S),g(S,e[0]),T(w,O),T(w,k),o&&m(q),q=[b(S,"input",e[5]),b(w,"submit",C(e[2]))]},p(e,[a]){2&a&&v(F,e[1]),1&a&&S.value!==e[0]&&g(S,e[0])},i:P,o:P,d(e){e&&i(a),e&&i(t),e&&i(E),e&&i(y),e&&i(N),e&&i(w),m(q)}}}function w(e,a,t){let r,s="",n="",o=!1;return E(()=>{console.log("App mounted");const e=F();r=e.requestTradePartner,e.subscribe(e=>{o=e.isTrading,t(1,n=e.tradePartnerFriendCode||"")})}),[s,n,e=>{o||r(s)},o,r,function(){s=this.value,t(0,s)}]}export default class extends a{constructor(e){super(),t(this,e,w,N,r,{})}}
